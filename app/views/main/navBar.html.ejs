<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div data-role="header">
        <div data-type="horizontal" data-group="controlgroup" class="ui-btn-left">
          <a href="#" onClick="history.back()" id="back_button" name="back" value="Back" data-inline="true" data-theme="a" data-role="button">Back</a>
        </div>
        <h1>
          Group Activity Planner
        </h1>
        <div data-type="horizontal" data-group="controlgroup" class="ui-btn-right">
          <% if (user) {%>
            <div id="container">
              <div id="welcome_container">
                <p>Welcome: 
                  <div id="username_container">
                    <a href="/events/myevents">
                      <span class="full_name">
                        <%=user.givenName%> <%=user.familyName%>
                      </span>
                      <span class="badgeContainer">
                        <img src="/img/facebook-blank-photo.jpg" width="25" id="blankPhoto">
                        <span class="badge"></span>
                      </span>
                    </a>
                  </div>
                </p>
              </div>
              <a href="/logout" id="logout_button" target="_parent" type="submit" name="logout" value="Logout" data-inline="true" data-theme="a" data-role="button">Logout</a>
            </div>
            <script type='text/javascript'>
              $('.badge').hide();
              var badgeNum = 0;
              var userName = '<%= user.username %>';

              var href = document.location.protocol + document.location.hostname;
              console.log('href = ' + href);
              var socket = io.connect(href);
              var eventName = userName + 'InviteEvent';
              console.log("Listening for " + eventName);

              <% if (user.mynotifications) { %>
                badgeNum = <%= user.mynotifications %>;
                if (badgeNum > 0){
                  $('.badge').html(badgeNum);
                  $('.badge').show();
                }
              <% } %>

              socket.on(eventName, function (data) {
                console.log("GOT THE EVENT:" + data);
                console.log(data);
                
                console.log("USER NOTIFICATIONS: <%=user.mynotifications%>");
                badgeNum += 1;
                $('.badge').html(badgeNum);
                $('.badge').show();
              });
            </script>
          <% } else { %>
            <a href="/login" id="login_button" target="_parent" type="submit" name="login" value="Login" data-inline="true" data-theme="a" data-role="button">Login</a>
            <a href="/users/add" id="sign_up_button" target="_parent" type="submit" name="signup" value="Sign Up" data-inline="true" data-theme="a" data-role="button">Sign Up</a>
          <% } %>
        </div>
      </div>
    </div>
  </div>